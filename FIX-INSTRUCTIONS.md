# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å "hold" vs "held"

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞: –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –º–µ—Å—Ç –Ω–∞ —Å—Ö–µ–º–µ –∑–∞–ª–∞, —Å—Ç–∞—Ç—É—Å –º–µ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫ `"hold"` –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ `"held"`. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–∞–º, —Ç–∞–∫ –∫–∞–∫ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –æ–∂–∏–¥–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å `"held"`.

## –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –ù–∞–π—Ç–∏ –∏ –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª src/lib/supabase.js

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–ª–∏–µ–Ω—Ç–∞ Supabase –∏ —è–≤–ª—è–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω—ã–º –º–µ—Å—Ç–æ–º –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API.

### 2. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ fetch

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–ª–∏–µ–Ω—Ç–∞ Supabase:

```javascript
// –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º fetch –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å "hold"/"held"
const customFetch = (...args) => {
  const [url, options = {}] = args;
  
  // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ–±–ª–µ–º—É —Å 'hold'/'held' —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Ç–∞–±–ª–∏—Ü–µ –º–µ—Å—Ç
  if (url.includes('event_seats_fanaticka_7a3x9d') && options?.method === 'PATCH') {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º body
    if (options.body) {
      const bodyText = typeof options.body === 'string' ? options.body : JSON.stringify(options.body);
      
      // –ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏–º 'hold' –≤–º–µ—Å—Ç–æ 'held', –∏—Å–ø—Ä–∞–≤–ª—è–µ–º
      if (bodyText.includes('"hold"')) {
        console.log('‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ "hold" –≤ –∑–∞–ø—Ä–æ—Å–µ, –∏—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ "held"');
        
        if (typeof options.body === 'string') {
          options.body = options.body.replace('"hold"', '"held"');
        } else {
          // –ï—Å–ª–∏ body - –æ–±—ä–µ–∫—Ç
          const bodyObj = typeof options.body === 'object' ? options.body : JSON.parse(options.body);
          if (bodyObj.status === 'hold') {
            bodyObj.status = 'held';
            options.body = JSON.stringify(bodyObj);
          }
        }
        
        console.log('‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞:', options.body);
      }
    }
  }
  
  return fetch(...args);
};
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ –≤ –∫–ª–∏–µ–Ω—Ç–µ Supabase

–ò–∑–º–µ–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ Supabase, –¥–æ–±–∞–≤–∏–≤ –æ–ø—Ü–∏—é `global.fetch`:

```javascript
const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
  auth: {
    persistSession: true,
    autoRefreshToken: true
  },
  realtime: {
    // Enable Realtime for real-time updates
    timeout: 30000, // 30 seconds timeout
    heartbeat: {
      interval: 15000, // 15 seconds heartbeat interval
    }
  },
  global: {
    fetch: customFetch // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—à –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ fetch
  }
})
```

### 4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ src/constants/seatStatus.js

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `src/constants/seatStatus.js` –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `HELD` –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `'held'`, –∞ –Ω–µ `'hold'`:

```javascript
export const SEAT_STATUS = {
  FREE: 'free',
  HELD: 'held', // –í–ê–ñ–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º 'held', –∞ –Ω–µ 'hold'
  SOLD: 'sold',
  BOOKED: 'booked'
};
```

–¢–∞–∫–∂–µ –¥–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞:

```javascript
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
export const getSafeStatus = (status) => {
  // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º 'hold' –Ω–∞ 'held' –µ—Å–ª–∏ –æ–Ω –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Å–∏—Å—Ç–µ–º—É
  if (status === 'hold') {
    console.warn('‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å "hold" –Ω–∞ "held"');
    return SEAT_STATUS.HELD;
  }
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å—Ç–∞—Ç—É—Å –¥–æ–ø—É—Å—Ç–∏–º—ã–º
  if (Object.values(SEAT_STATUS).includes(status)) {
    return status;
  }
  
  // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º FREE
  console.warn(`‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å "${status}", –∏—Å–ø–æ–ª—å–∑—É–µ–º "free" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é`);
  return SEAT_STATUS.FREE;
};
```

### 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å getSafeStatus –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

–í —Ñ–∞–π–ª–∞—Ö, –≥–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –º–µ—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `src/services/seatMapService.js`), –∑–∞–º–µ–Ω–∏—Ç–µ –ø—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –Ω–∞ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `getSafeStatus`:

```javascript
// –ë—ã–ª–æ
const status = seat.status;

// –°—Ç–∞–ª–æ
import { getSafeStatus } from '../constants/seatStatus';
const status = getSafeStatus(seat.status);
```

### 6. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –∏ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
npm run dev

# –ï—Å–ª–∏ production:
npm run build && npm run preview
```

–í –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞–∂–º–∏—Ç–µ Ctrl+Shift+R –¥–ª—è –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å –æ—á–∏—Å—Ç–∫–æ–π –∫—ç—à–∞.

### 7. –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É Network
3. –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ —Å—Ö–µ–º–µ –∑–∞–ª–∞
4. –ù–∞–π–¥–∏—Ç–µ PATCH –∑–∞–ø—Ä–æ—Å –∫ —Ç–∞–±–ª–∏—Ü–µ `event_seats_fanaticka_7a3x9d`
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `"held"`, –∞ –Ω–µ `"hold"`
6. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ—Ç–≤–µ—Ç –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å 200 OK

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–±–ª–µ–º—ã

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É –±–µ–∑ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥, –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π —Å–∫—Ä–∏–ø—Ç –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ `index.html` –ø–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –¥—Ä—É–≥–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏:

```html
<script>
  (function() {
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
      const [url, options] = args;
      
      if (url.includes('event_seats_fanaticka_7a3x9d') && 
          options?.method === 'PATCH' || 
          options?.method === 'POST') {
        
        console.group('üîç –ü–ï–†–ï–•–í–ê–ß–ï–ù –ó–ê–ü–†–û–° –ö –¢–ê–ë–õ–ò–¶–ï –ú–ï–°–¢');
        console.log('URL:', url);
        console.log('–ú–µ—Ç–æ–¥:', options.method);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º body
        let body = options.body;
        if (body) {
          const bodyStr = typeof body === 'string' ? body : JSON.stringify(body);
          console.log('Body –¥–æ:', bodyStr);
          
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ "hold" –≤ –∑–∞–ø—Ä–æ—Å–µ
          if (bodyStr.includes('"hold"')) {
            console.error('‚ùå –ù–ê–ô–î–ï–ù–û "hold" –í –ó–ê–ü–†–û–°–ï!');
            console.trace('–°—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤:');
          }
        }
        
        console.groupEnd();
      }
      
      return originalFetch.apply(this, args);
    };
  })();
</script>
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ —Ç–∞–±–ª–∏—Ü–µ –º–µ—Å—Ç –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å, –µ—Å–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å "hold".